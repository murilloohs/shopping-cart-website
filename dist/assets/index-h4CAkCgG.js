(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(t){if(t.ep)return;t.ep=!0;const c=n(t);fetch(t.href,c)}})();const E=()=>{},f=()=>{const e=localStorage.getItem("cartProducts");return e?JSON.parse(e):[]},v=()=>{const e=localStorage.getItem("price");return e?JSON.parse(e):[]},I=(e,r)=>{if(!e)throw new Error("Você deve fornecer um ID");const o=[...f(),e];localStorage.setItem("cartProducts",JSON.stringify(o));const c=[...v(),r];localStorage.setItem("price",JSON.stringify(c))},O=e=>{if(!e)throw new Error("Você deve fornecer um ID");function r(t,c){const a=t.indexOf(c);return a!==-1&&t.splice(a,1),t}const n=f(),o=r(n,e);localStorage.setItem("cartProducts",JSON.stringify(o))},m=e=>{const r=document.createElement("img");return r.className="product__image",r.src=e.replace("I.jpg","O.jpg"),r},s=(e,r,n="")=>{const o=document.createElement(e);return o.className=r,o.innerText=n,o},N=(e,r)=>{e.remove(),O(r)},C=({id:e,title:r,price:n,pictures:o})=>{const t=document.createElement("li");t.className="cart__product";const c=s("div","cart__product__image-container"),a=m(o[0].url);c.appendChild(a);const d=m((o[1]||o[0]).url);c.appendChild(d),t.appendChild(c);const l=s("div","cart__product__info-container");l.appendChild(s("span","product__title",r));const h=s("span","product__price","R$ ");h.appendChild(s("span","product__price__value",n)),l.appendChild(h),t.appendChild(l);const y=s("i","material-icons cart__product__remove","delete");return t.appendChild(y),t.addEventListener("click",()=>N(t,e)),t},T=({id:e,title:r,thumbnail:n,price:o})=>{const t=document.createElement("section");t.className="product",t.appendChild(s("span","product__id",e));const c=s("div","img__container");c.appendChild(m(n)),t.appendChild(c),t.appendChild(s("span","product__title",r));const a=s("span","product__price","R$ ");a.appendChild(s("span","product__price__value",o)),t.appendChild(a);const d=s("button","product__add","Adicionar ao carrinho!");return t.appendChild(d),t},P=async e=>{if(!e)throw new Error("ID não informado");const r=`https://api.mercadolibre.com/items/${e}`;return await(await fetch(r)).json()},L=async e=>{if(!e)throw new Error("Termo de busca não informado");const r=`https://api.mercadolibre.com/sites/MLB/search?q=${e}`;return(await(await fetch(r)).json()).results},u=document.querySelector(".products");document.querySelector(".cep-button").addEventListener("click",E);const w=()=>{const e=document.createElement("p");e.className="loading",e.innerHTML="carregando...",u.appendChild(e)},_=()=>{const e=document.querySelector(".loading");u.removeChild(e)},p=document.querySelector(".total-price");let i=[0],g=0;const x=()=>{let e=JSON.parse(localStorage.getItem("price"));e===null&&(e=[]),i=e;let r=e.reduce((o,t)=>o+t,0);p.innerText=r;const n=document.querySelectorAll(".cart__product");n.forEach((o,t)=>{o.addEventListener("click",()=>{e=JSON.parse(localStorage.getItem("price"));const c=e[t+1];i=e.filter(a=>a!==c),r=i.reduce((a,d)=>a+d,0),p.innerText=r,localStorage.setItem("price",JSON.stringify(i))})}),n===0&&(p.innerText=0)},S=document.querySelector(".cart__products"),D=()=>f().forEach(async e=>{const r=await P(e);S.appendChild(C(r))});D();const J=e=>{i.push(e),localStorage.setItem("price",JSON.stringify(i));const n=JSON.parse(localStorage.getItem("price")).reduce((o,t)=>o+t);p.innerText=n.toFixed(2)},b=e=>{document.querySelectorAll(".cart__product")[g].addEventListener("click",()=>{i=i.filter(t=>t!==e),localStorage.setItem("price",JSON.stringify(i));const o=JSON.parse(localStorage.getItem("price")).reduce((t,c)=>t+c,0);p.innerText=o.toFixed(2),g-=1})},q=async e=>{const{target:r}=e,n=r.parentElement.firstChild.innerHTML;console.log("DENTRO ADDTOCART");const o=await P(n),t=C(o);S.appendChild(t);const c=o.price;I(n,c),J(c),b(c),g+=1};try{w(),(async()=>{const r=await L("computador");(()=>{r.forEach(t=>{const{id:c,title:a,thumbnail:d,price:l}=t;u.appendChild(T({id:c,title:a,thumbnail:d,price:l}))}),x(),_(),document.querySelectorAll(".product__add").forEach(t=>t.addEventListener("click",q))})()})()}catch{_();const r=document.createElement("p");r.className="error",r.innerHTML="Algum erro ocorreu, recarregue a página e tente novamente",u.appendChild(r)}
